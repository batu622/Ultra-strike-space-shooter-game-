<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Nebula Strike</title>
<style>
  body { margin: 0; background: black; overflow: hidden; }
  canvas { display: block; margin: auto; background: black; }
</style>
</head>
<body>
<canvas id="game" width="480" height="640"></canvas>

<script>
// -------------------------------
// ðŸ”Š SES MOTORU
// -------------------------------
const sounds = {
  fire: new Audio("sounds/fire.wav"),
  explode: new Audio("sounds/explode.wav"),
  hit: new Audio("sounds/hit.wav"),
  pickup: new Audio("sounds/pickup.wav"),
  boss: new Audio("sounds/boss.wav")
};

function playSound(name) {
  if (sounds[name]) {
    const s = sounds[name].cloneNode();
    s.volume = 0.6;
    s.play();
  }
}

// -------------------------------
// ðŸŽ® OYUN KURULUMU
// -------------------------------
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let keys = {};
let bullets = [];
let enemies = [];
let particles = [];
let powerups = [];
let score = 0;
let hp = 100;
let boss = null;
let difficulty = "Normal";

const DIFF = {
  Easy: { dmgTaken: 8, spawnRate: 0.9 },
  Normal: { dmgTaken: 14, spawnRate: 1.3 },
  Hard: { dmgTaken: 18, spawnRate: 1.7 }
};

// -------------------------------
// ðŸš€ Oyuncu
// -------------------------------
let player = {
  x: 240,
  y: 560,
  vx: 0,
  vy: 0,
  speed: 200,
  fireRate: 0.22,
  fireTimer: 0,
  weapon: "Normal"
};

// -------------------------------
// âœ¨ Efekt
// -------------------------------
function spawnExplosion(x, y) {
  for (let i=0;i<18;i++){
    particles.push({
      x: x, y: y,
      v: Math.random()*3,
      a: Math.random()*Math.PI*2,
      life: 0.7,
      max: 0.7,
      r: Math.random()*4+2
    });
  }
}

// -------------------------------
// ðŸ”« AteÅŸ
// -------------------------------
function fire(){
  if (player.fireTimer <= 0) {

    playSound("fire"); // ðŸ”Š AteÅŸ sesi

    const spread = player.weapon==="Twin" ? [-8,8] : [0];
    spread.forEach(dx=>{
      bullets.push({
        x: player.x + dx,
        y: player.y - 26,
        vx: 0,
        vy: -560,
        r: 3.5,
        color: "rgba(120,220,255,0.9)",
        t: 0
      });
    });
    player.fireTimer = player.fireRate;
  }
}

// -------------------------------
// ðŸ‘¾ DÃ¼ÅŸman yarat
// -------------------------------
function spawnEnemy(){
  const type = Math.random()<0.6 ? "fighter" : "tank";
  enemies.push({
    x: Math.random()*440+20,
    y: -30,
    r: type==="fighter"?18:26,
    hp: type==="fighter"?18:32,
    type: type,
    vy: type==="fighter"?70:40
  });
}

// -------------------------------
// ðŸ§Š Power-up
// -------------------------------
function spawnPowerup(x,y){
  powerups.push({
    x,y, r:16,
    type: Math.random()<0.5 ? "heal" : "twin"
  });
}

// -------------------------------
// ðŸ§  ANA OYUN DÃ–NGÃœSÃœ
// -------------------------------
let last=0;
let enemyTimer=0;

function update(t){
  let dt = (t-last)/1000;
  last = t;
  if (dt>0.2) dt=0.2;

  player.fireTimer -= dt;

  // Hareket
  player.vx = (keys["ArrowRight"]?1:0)-(keys["ArrowLeft"]?1:0);
  player.vy = (keys["ArrowDown"]?1:0)-(keys["ArrowUp"]?1:0);
  player.x += player.vx * player.speed * dt;
  player.y += player.vy * player.speed * dt;
  player.x = Math.max(20, Math.min(460, player.x));
  player.y = Math.max(40, Math.min(600, player.y));

  if (keys[" "] || keys["Space"]) fire();

  // Mermiler
  for (let i=bullets.length-1;i>=0;i--){
    let b = bullets[i];
    b.y += b.vy * dt;
    if (b.y < -10) bullets.splice(i,1);
  }

  // DÃ¼ÅŸmanlar
  for (let i=enemies.length-1;i>=0;i--){
    let e = enemies[i];
    e.y += e.vy * dt;

    // Oyuncuya temas âžœ hasar
    let dx = e.x - player.x;
    let dy = e.y - player.y;
    if (dx*dx + dy*dy < (e.r+20)*(e.r+20)) {
      hp -= DIFF[difficulty].dmgTaken;

      playSound("hit"); // ðŸ”Š Oyuncu hasar sesi

      enemies.splice(i,1);
      continue;
    }

    // Mermi Ã§arpma
    for (let j=bullets.length-1;j>=0;j--){
      let b = bullets[j];
      let dx2 = e.x - b.x;
      let dy2 = e.y - b.y;
      if (dx2*dx2 + dy2*dy2 < (e.r+b.r)*(e.r+b.r)) {

        e.hp -= 10;
        bullets.splice(j,1);

        if (e.hp <= 0){

          playSound("explode"); // ðŸ”Š DÃ¼ÅŸman patlama sesi

          score += e.type==="fighter" ? 6 : 10;
          spawnExplosion(e.x,e.y);

          if (Math.random()<0.22) spawnPowerup(e.x,e.y);

          enemies.splice(i,1);
        }
      }
    }
  }

  // Power-up temas
  for (let i=powerups.length-1;i>=0;i--){
    let p = powerups[i];
    let dx = p.x - player.x;
    let dy = p.y - player.y;
    if (dx*dx + dy*dy < 40*40){
      
      playSound("pickup"); // ðŸ”Š Power-up sesi

      if (p.type==="heal") hp = Math.min(100, hp+30);
      if (p.type==="twin") player.weapon="Twin";
      powerups.splice(i,1);
    }
  }

  // DÃ¼ÅŸman spawn
  enemyTimer += dt;
  if (enemyTimer > 1.1 / DIFF[difficulty].spawnRate){
    enemyTimer = 0;
    spawnEnemy();
  }

  // ParÃ§acÄ±klar
  for (let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.life -= dt;
    p.x += Math.cos(p.a)*p.v*60*dt;
    p.y += Math.sin(p.a)*p.v*60*dt;
    if (p.life <= 0) particles.splice(i,1);
  }

  // Boss spawn (Ã¶rnek)
  if (!boss && score > 220){
    boss = {
      x:240, y:80,
      hp:800,
      r:60,
      vx:80
    };
  }

  if (boss){
    // Basit boss hareketi
    boss.x += boss.vx*dt;
    if (boss.x<80 || boss.x>400) boss.vx *= -1;

    // Mermi Ã§arpma
    for (let i=bullets.length-1;i>=0;i--){
      let b = bullets[i];
      let dx=b.x-boss.x, dy=b.y-boss.y;
      if (dx*dx+dy*dy < (boss.r+b.r)*(boss.r+b.r)){
        bullets.splice(i,1);
        boss.hp -= 8;

        if (boss.hp <= 0){
          playSound("boss"); // ðŸ”Š BOSS PATLAMA SESÄ°

          score += 180;
          spawnExplosion(boss.x,boss.y);
          boss=null;
        }
      }
    }
  }

  draw();
  requestAnimationFrame(update);
}

// -------------------------------
// ðŸŽ¨ Ã‡izim
// -------------------------------
function draw(){
  ctx.clearRect(0,0,480,640);

  // Oyuncu
  ctx.fillStyle="white";
  ctx.beginPath();
  ctx.arc(player.x, player.y, 20, 0, Math.PI*2);
  ctx.fill();

  // Mermiler
  bullets.forEach(b=>{
    ctx.fillStyle=b.color;
    ctx.beginPath();
    ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
    ctx.fill();
  });

  // DÃ¼ÅŸmanlar
  enemies.forEach(e=>{
    ctx.fillStyle=e.type==="fighter"?"red":"orange";
    ctx.beginPath();
    ctx.arc(e.x,e.y,e.r,0,Math.PI*2);
    ctx.fill();
  });

  // Powerups
  powerups.forEach(p=>{
    ctx.fillStyle = p.type==="heal"?"lime":"cyan";
    ctx.beginPath();
    ctx.arc(p.x,p.y,16,0,Math.PI*2);
    ctx.fill();
  });

  // Boss
  if (boss){
    ctx.fillStyle="purple";
    ctx.beginPath();
    ctx.arc(boss.x,boss.y,boss.r,0,Math.PI*2);
    ctx.fill();
  }

  // ParÃ§acÄ±klar
  particles.forEach(p=>{
    ctx.fillStyle="rgba(255,140,0,"+(p.life/p.max)+")";
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fill();
  });

  // UI
  ctx.fillStyle="white";
  ctx.font="18px Arial";
  ctx.fillText("HP: "+hp,20,30);
  ctx.fillText("Score: "+score,380,30);
}

// -------------------------------
// âŒ¨ Kontroller
// -------------------------------
document.addEventListener("keydown",e=>keys[e.key]=true);
document.addEventListener("keyup",e=>keys[e.key]=false);

// BaÅŸlat
requestAnimationFrame(update);
</script>
</body>
</html>
